<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ƒêƒÉng K√Ω L·ªÖ H·∫±ng Thu·∫≠n - Ch√πa B·ª≠u ƒê√†</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@300;400;500;600;700&family=Merriweather:ital,wght@0,400;0,700;0,900;1,400&display=swap" rel="stylesheet">

    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        /* C·∫§U H√åNH FONT */
        body { 
            font-family: 'Be Vietnam Pro', sans-serif; 
            color: #44403c; 
        }
        
        /* C·∫§U H√åNH RI√äNG CHO TI√äU ƒê·ªÄ */
        .font-serif { 
            font-family: 'Merriweather', serif !important; /* ∆Øu ti√™n tuy·ªát ƒë·ªëi */
            
            /* 2. √âP BU·ªòC VI·∫æT HOA TO√ÄN B·ªò */
            text-transform: uppercase !important;
            
            /* 3. T·∫†O KHO·∫¢NG C√ÅCH CHO D·∫§U KH√îNG B·ªä D√çNH */
            line-height: 1.6 !important; /* TƒÉng chi·ªÅu cao d√≤ng */
            letter-spacing: 1.5px;       /* TƒÉng kho·∫£ng c√°ch gi·ªØa c√°c ch·ªØ c√°i cho tho√°ng */
            padding-top: 10px;           /* Th√™m kho·∫£ng tr·ªëng ph√≠a tr√™n */
            padding-bottom: 10px;
        }

        /* X·ª≠ l√Ω c√°c th·∫ª H1, H2 m·∫∑c ƒë·ªãnh c·ªßa Tailwind ƒë·ªÉ kh√¥ng b·ªã c·∫Øt ch·ªØ */
        h1, h2, h3 {
            line-height: 1.6 !important;
        }

        /* C√°c hi·ªáu ·ª©ng c≈© */
        .fade-in { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .loader { border: 3px solid #f3f3f3; border-top: 3px solid #b45309; border-radius: 50%; width: 24px; height: 24px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
</head>
<body class="bg-amber-50/30 text-stone-800">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // --- C·∫§U H√åNH H·ªÜ TH·ªêNG ---
        const ADMIN_PASSWORD = "Dongthinh@419/11"; 
        const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzqgMOXQ_fhLz7vGGxPjrzobjwpqiJI5hxlp-NenQPk-UcLaqu0HZ6dmz-8iTYih2Sw/exec"; 
        
        const TEMPLE_NAME = "Ch√πa B·ª≠u ƒê√†";
        const TEMPLE_ADDRESS = "419/11 C√°ch M·∫°ng Th√°ng 8, P.Ho√† H∆∞ng, Q.10, Tp.HCM";
        const TEMPLE_PHONES = "0918.205.180 - 0703.676.073";
        const TEMPLE_EMAIL = "buudapagoda@gmail.com";

        // --- ICONS ---
        const Icons = {
            Plus: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M5 12h14"/><path d="M12 5v14"/></svg>,
            ListFilter: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 6h18"/><path d="M7 12h10"/><path d="M10 18h4"/></svg>,
            Phone: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.05 12.05 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.03 12.03 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>,
            ArrowLeft: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></svg>,
            Calendar: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></svg>,
            Trash2: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg>,
            Pencil: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>,
            Users: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>,
            Utensils: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"/><path d="M7 2v20"/><path d="M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7"/></svg>,
            Flower: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="3"/><path d="M12 16.5A4.5 4.5 0 1 1 7.5 12 4.5 4.5 0 1 1 12 7.5a4.5 4.5 0 1 1 4.5 4.5 4.5 4.5 0 1 1-4.5 4.5"/><path d="M12 7.5V9"/><path d="M7.5 12H9"/><path d="M16.5 12H15"/><path d="M12 16.5V15"/><path d="M8 8l.7.7"/><path d="M16 8l-.7.7"/><path d="M16 16l-.7-.7"/><path d="M8 16l.7-.7"/></svg>,
            Camera: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"/><circle cx="12" cy="13" r="3"/></svg>,
            Sparkles: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/><path d="M5 3v4"/><path d="M9 3v4"/><path d="M3 5h4"/><path d="M3 9h4"/></svg>,
            Download: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/></svg>,
            Refresh: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M8 16H3v5"/></svg>,
            Lock: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="18" height="11" x="3" y="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>,
            CheckCircle: () => <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="green" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>,
            AlertCircle: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" x2="12" y1="8" y2="12"/><line x1="12" x2="12.01" y1="16" y2="16"/></svg>,
            Eye: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></svg>
        };

        const generateCeremonyScript = async (ceremony) => {
            return new Promise((resolve) => resolve(`CH∆Ø∆†NG TR√åNH L·ªÑ H·∫∞NG THU·∫¨N\nT·∫°i: ${TEMPLE_NAME}\n... (K·ªãch b·∫£n chi ti·∫øt gi·∫£ l·∫≠p) ...`));
        };

        // --- H√ÄM T·∫†O FILE WORD ---
        const createWordBlob = (ceremony) => {
            const formatDate = (dateStr) => dateStr ? new Date(dateStr).toLocaleDateString('vi-VN', { day: 'numeric', month: 'long', year: 'numeric' }) : '---';
            const getMediaText = () => ceremony.mediaOption === 'temple' ? 'Nh·ªù Ch√πa h·ªó tr·ª£' : 'Gia ƒë√¨nh t·ª± thu√™ th·ª£ ri√™ng';
            
            const htmlContent = `
                <html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'>
                <head>
                    <meta charset="utf-8">
                    <title>ƒêƒÉng K√Ω L·ªÖ H·∫±ng Thu·∫≠n</title>
                    <style>
                        body { font-family: 'Times New Roman', serif; font-size: 12pt; }
                        h1, h2 { text-align: center; font-weight: bold; text-transform: uppercase; margin: 5px 0; }
                        .section-title { font-weight: bold; border-bottom: 1px solid black; margin: 20px 0 10px 0; text-transform: uppercase; font-size: 11pt; }
                        table { width: 100%; border-collapse: collapse; margin-bottom: 10px; }
                        td { padding: 4px; vertical-align: top; }
                        .label { font-weight: bold; width: 160px; }
                        .sub-info { font-style: italic; font-size: 10pt; text-align: center; }
                        .contact-box { border: 1px solid #000; padding: 10px; margin-top: 10px; text-align: center; font-weight: bold; }
                        .email-guide { text-align: center; color: red; font-style: italic; font-weight: bold; margin-bottom: 20px; border: 1px dashed red; padding: 5px; }
                    </style>
                </head>
                <body>
                    <p style="text-align: center; font-weight: bold; color: #555; margin: 0;">GI√ÅO H·ªòI PH·∫¨T GI√ÅO VI·ªÜT NAM - TP.HCM</p>
                    <h1>Ch√πa B·ª≠u ƒê√†</h1>
                    <p class="sub-info">419/11 C√°ch M·∫°ng Th√°ng 8, P.Ho√† H∆∞ng, Q.10, Tp.HCM</p>
                    <p class="sub-info">ƒêi·ªán tho·∫°i: 0918.205.180 - 0703.676.073</p>
                    <hr width="50%" />
                    <div class="email-guide">Qu√Ω gia ƒë√¨nh vui l√≤ng g·ª≠i file n√†y v·ªÅ email: buudapagoda@gmail.com</div>
                    <h2>PHI·∫æU ƒêƒÇNG K√ù L·ªÑ H·∫∞NG THU·∫¨N</h2>
                    <p style="text-align: center;">M√£ h·ªì s∆°: <b>#${ceremony.id.slice(-6)}</b></p>
                    <div class="contact-box">NG∆Ø·ªúI LI√äN H·ªÜ / ƒê·∫†I DI·ªÜN: ${ceremony.contactPhone}</div>
                    <div class="section-title">I. TH·ªúI GIAN & ƒê·ªäA ƒêI·ªÇM</div>
                    <table border="1" style="border: 1px solid #ccc;">
                        <tr><td class="label">Ng√†y d∆∞∆°ng l·ªãch:</td><td><b>${formatDate(ceremony.date)}</b></td><td class="label">Ng√†y √¢m l·ªãch:</td><td>${ceremony.lunarDate}</td></tr>
                        <tr><td class="label">Gi·ªù l√†m l·ªÖ:</td><td><b>${ceremony.time}</b></td><td class="label">S·ªë l∆∞·ª£ng kh√°ch:</td><td>${ceremony.guestCount} ng∆∞·ªùi</td></tr>
                    </table>
                    <div class="section-title">II. TH√îNG TIN HAI H·ªå</div>
                    <table border="1" style="border: 1px solid #ccc;">
                        <tr style="background-color: #f0f0f0;"><td colspan="2" style="text-align:center;"><b>NH√Ä TRAI</b></td><td colspan="2" style="text-align:center;"><b>NH√Ä G√ÅI</b></td></tr>
                        <tr><td class="label">T√¢n Lang:</td><td><b>${ceremony.groom.fullName}</b></td><td class="label">T√¢n N∆∞∆°ng:</td><td><b>${ceremony.bride.fullName}</b></td></tr>
                        <tr><td class="label">Ph√°p danh:</td><td>${ceremony.groom.dharmaName}</td><td class="label">Ph√°p danh:</td><td>${ceremony.bride.dharmaName}</td></tr>
                        <tr><td class="label">SƒêT C√° nh√¢n:</td><td>${ceremony.groom.phone}</td><td class="label">SƒêT C√° nh√¢n:</td><td>${ceremony.bride.phone}</td></tr>
                        <tr><td class="label">Cha:</td><td>${ceremony.groom.fatherName}</td><td class="label">Cha:</td><td>${ceremony.bride.fatherName}</td></tr>
                        <tr><td class="label">M·∫π:</td><td>${ceremony.groom.motherName}</td><td class="label">M·∫π:</td><td>${ceremony.bride.motherName}</td></tr>
                        <tr><td class="label">ƒê·ªãa ch·ªâ:</td><td>${ceremony.groom.address}</td><td class="label">ƒê·ªãa ch·ªâ:</td><td>${ceremony.bride.address}</td></tr>
                    </table>
                    <div class="section-title">III. Y√äU C·∫¶U KH√ÅC</div>
                    <ul>
                        <li><b>Ti·ªác chay:</b> ${ceremony.hasBanquet ? `C√≥ (${ceremony.banquetTables} b√†n - 10 ng∆∞·ªùi/b√†n)` : 'Kh√¥ng'}</li>
                        <li><b>Trang tr√≠ hoa:</b> ${ceremony.flowerPreferences || 'Theo s·ª± s·∫Øp x·∫øp c·ªßa Ch√πa'}</li>
                        <li><b>Media/Quay ch·ª•p:</b> ${getMediaText()}</li>
                        <li><b>Ghi ch√∫/S√≠nh l·ªÖ:</b> ${ceremony.offeringsInfo || 'Kh√¥ng c√≥'}</li>
                    </ul>
                </body>
                </html>
            `;
            return new Blob(['\ufeff', htmlContent], { type: 'application/msword' });
        };

        // --- COMPONENT: FORM ƒêƒÇNG K√ù ---
        const RegistrationForm = ({ onSubmit, onCancel, initialData, isSaving, isAdminMode, bookedDates }) => {
            const [formData, setFormData] = useState(initialData || {
                id: '', contactPhone: '',
                groom: { fullName: '', dharmaName: '', birthYear: '', phone: '', fatherName: '', motherName: '', address: '' },
                bride: { fullName: '', dharmaName: '', birthYear: '', phone: '', fatherName: '', motherName: '', address: '' },
                date: new Date().toISOString().split('T')[0], time: '09:00', lunarDate: '',
                guestCount: '0', banquetTables: '', hasBanquet: false, mediaOption: 'own', flowerPreferences: '',
                ceremonyBoardContent: 'L·ªÖ H·∫±ng Thu·∫≠n', offeringsInfo: '', notes: ''
            });

            const [dateError, setDateError] = useState("");
            const [showBookedDates, setShowBookedDates] = useState(false);

            const handleKeyDown = (e) => {
                if (e.key === 'Enter') {
                    if (e.target.tagName === 'TEXTAREA' || e.target.type === 'submit' || e.target.type === 'button') return;
                    e.preventDefault();
                    const form = e.currentTarget;
                    const focusable = Array.from(form.querySelectorAll('input:not([type="hidden"]), select, textarea, button[type="submit"]'))
                        .filter(el => !el.disabled && !el.readOnly && el.type !== 'radio' && el.type !== 'checkbox');
                    const index = focusable.indexOf(e.target);
                    if (index > -1 && index < focusable.length - 1) focusable[index + 1].focus();
                }
            };

            const checkDateAvailability = (selectedDate) => {
                if (!isAdminMode && bookedDates && bookedDates.includes(selectedDate)) {
                    setDateError("‚ö†Ô∏è Ng√†y n√†y Nh√† Ch√πa ƒë√£ c√≥ l·ªãch ƒëƒÉng k√Ω. Vui l√≤ng ch·ªçn ng√†y kh√°c.");
                    return false;
                }
                setDateError("");
                return true;
            };

            useEffect(() => {
                if(formData.date) {
                    checkDateAvailability(formData.date);
                }
            }, [formData.date, bookedDates]);

            useEffect(() => {
                if (initialData) {
                    setFormData(prev => ({
                        ...prev,
                        contactPhone: initialData.contactPhone || initialData.groom?.familyPhone || '',
                        mediaOption: initialData.mediaOption || (initialData.hasMediaCrew ? 'own' : 'temple')
                    }));
                }
            }, [initialData]);

            const handleChange = (section, field, value) => {
                if (section === 'root') setFormData(prev => ({ ...prev, [field]: value }));
                else setFormData(prev => ({ ...prev, [section]: { ...prev[section], [field]: value } }));
            };

            const handleSubmit = (e) => {
                e.preventDefault();
                if (!checkDateAvailability(formData.date)) {
                    alert("Ng√†y b·∫°n ch·ªçn ƒë√£ b·ªã tr√πng l·ªãch. Vui l√≤ng ki·ªÉm tra l·∫°i!");
                    return;
                }
                const dataToSubmit = { ...formData, id: formData.id || Date.now().toString() };
                onSubmit(dataToSubmit);
            };

            return (
                <div className="bg-white rounded-xl shadow-lg p-6 max-w-4xl mx-auto fade-in border border-stone-200 mb-10 relative">
                    {isSaving && (
                        <div className="absolute inset-0 bg-white/90 z-20 flex flex-col items-center justify-center rounded-xl">
                            <div className="loader mb-4"></div>
                            <p className="text-amber-800 font-bold text-lg">ƒêang g·ª≠i h·ªì s∆° v·ªÅ Ch√πa...</p>
                            <p className="text-stone-500 text-sm mt-2">Vui l√≤ng kh√¥ng t·∫Øt tr√¨nh duy·ªát.</p>
                        </div>
                    )}
                    
                    <div className="flex justify-between items-center mb-6 border-b border-stone-100 pb-2">
                        <h2 className="text-2xl font-serif font-bold text-amber-700">
                            {initialData ? 'C·∫≠p Nh·∫≠t H·ªì S∆°' : 'ƒêƒÉng K√Ω L·ªÖ H·∫±ng Thu·∫≠n M·ªõi'}
                        </h2>
                        {!isAdminMode && (
                            <div className="bg-amber-100 text-amber-800 px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider">
                                Kh√°ch ƒêƒÉng K√Ω
                            </div>
                        )}
                    </div>

                    <form onSubmit={handleSubmit} onKeyDown={handleKeyDown} className="space-y-6">
                        <div className="bg-stone-50 p-4 rounded-lg border border-stone-100">
                            <h3 className="font-bold text-stone-700 flex items-center gap-2 mb-3 text-lg"><Icons.Users /> Nh√† Trai</h3>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div><label className="text-sm font-medium">H·ªç t√™n ch√∫ r·ªÉ *</label><input required className="w-full p-2 border rounded" placeholder="VD: Nguy·ªÖn VƒÉn A" value={formData.groom.fullName} onChange={e => handleChange('groom', 'fullName', e.target.value)} /></div>
                                <div><label className="text-sm font-medium">Ph√°p danh</label><input className="w-full p-2 border rounded" placeholder="VD: Minh Ki·∫øn" value={formData.groom.dharmaName} onChange={e => handleChange('groom', 'dharmaName', e.target.value)} /></div>
                                <div><label className="text-sm font-medium">Cha</label><input className="w-full p-2 border rounded" placeholder="H·ªç t√™n cha" value={formData.groom.fatherName} onChange={e => handleChange('groom', 'fatherName', e.target.value)} /></div>
                                <div><label className="text-sm font-medium">M·∫π</label><input className="w-full p-2 border rounded" placeholder="H·ªç t√™n m·∫π" value={formData.groom.motherName} onChange={e => handleChange('groom', 'motherName', e.target.value)} /></div>
                                <div className="md:col-span-2"><label className="text-sm font-medium">SƒêT C√° nh√¢n</label><input className="w-full p-2 border rounded" placeholder="VD: 09xx.xxx.xxx" value={formData.groom.phone} onChange={e => handleChange('groom', 'phone', e.target.value)} /></div>
                                <div className="md:col-span-2"><label className="text-sm font-medium">ƒê·ªãa ch·ªâ</label><input className="w-full p-2 border rounded" placeholder="S·ªë nh√†, ƒë∆∞·ªùng, ph∆∞·ªùng, qu·∫≠n..." value={formData.groom.address} onChange={e => handleChange('groom', 'address', e.target.value)} /></div>
                            </div>
                        </div>
                        <div className="bg-stone-50 p-4 rounded-lg border border-stone-100">
                            <h3 className="font-bold text-stone-700 flex items-center gap-2 mb-3 text-lg"><Icons.Users /> Nh√† G√°i</h3>
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div><label className="text-sm font-medium">H·ªç t√™n c√¥ d√¢u *</label><input required className="w-full p-2 border rounded" placeholder="VD: L√™ Th·ªã B" value={formData.bride.fullName} onChange={e => handleChange('bride', 'fullName', e.target.value)} /></div>
                                <div><label className="text-sm font-medium">Ph√°p danh</label><input className="w-full p-2 border rounded" placeholder="VD: Di·ªáu √Çm" value={formData.bride.dharmaName} onChange={e => handleChange('bride', 'dharmaName', e.target.value)} /></div>
                                <div><label className="text-sm font-medium">Cha</label><input className="w-full p-2 border rounded" placeholder="H·ªç t√™n cha" value={formData.bride.fatherName} onChange={e => handleChange('bride', 'fatherName', e.target.value)} /></div>
                                <div><label className="text-sm font-medium">M·∫π</label><input className="w-full p-2 border rounded" placeholder="H·ªç t√™n m·∫π" value={formData.bride.motherName} onChange={e => handleChange('bride', 'motherName', e.target.value)} /></div>
                                <div className="md:col-span-2"><label className="text-sm font-medium">SƒêT C√° nh√¢n</label><input className="w-full p-2 border rounded" placeholder="VD: 09xx.xxx.xxx" value={formData.bride.phone} onChange={e => handleChange('bride', 'phone', e.target.value)} /></div>
                                <div className="md:col-span-2"><label className="text-sm font-medium">ƒê·ªãa ch·ªâ</label><input className="w-full p-2 border rounded" placeholder="S·ªë nh√†, ƒë∆∞·ªùng, ph∆∞·ªùng, qu·∫≠n..." value={formData.bride.address} onChange={e => handleChange('bride', 'address', e.target.value)} /></div>
                            </div>
                        </div>
                        <div className="border-t border-stone-200 pt-4">
                            <h3 className="font-bold text-stone-700 mb-4 flex items-center gap-2 text-lg"><Icons.Calendar /> Chi ti·∫øt & Li√™n h·ªá</h3>
                            <div className="bg-amber-50 border border-amber-200 p-4 rounded-lg mb-4">
                                <label className="block text-sm font-bold text-amber-800 mb-1">S·ªë ƒëi·ªán tho·∫°i li√™n h·ªá ch√≠nh (ƒê·∫°i di·ªán) *</label>
                                <input required type="text" className="w-full p-2 border border-amber-300 rounded" placeholder="VD: 0903.xxx.xxx (C√¥ Ba - M·∫π ch√∫ r·ªÉ)" value={formData.contactPhone} onChange={e => handleChange('root', 'contactPhone', e.target.value)} />
                            </div>
                            <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div className="md:col-span-3">
                                    <div className="flex justify-between items-center mb-1">
                                        <label className="text-sm font-medium flex items-center gap-1">Ng√†y D∆∞∆°ng L·ªãch t·ªï ch·ª©c *</label>
                                        {!isAdminMode && <button type="button" onClick={() => setShowBookedDates(!showBookedDates)} className="text-xs text-blue-600 hover:underline flex items-center gap-1"><Icons.Eye /> {showBookedDates ? '·∫®n danh s√°ch ng√†y k√≠n' : 'Xem danh s√°ch ng√†y ƒë√£ k√≠n l·ªãch'}</button>}
                                    </div>
                                    
                                    {showBookedDates && bookedDates && bookedDates.length > 0 && (
                                        <div className="mb-2 p-2 bg-red-50 border border-red-100 rounded text-xs text-red-700">
                                            <b>C√°c ng√†y Ch√πa ƒë√£ c√≥ l·ªãch (Vui l√≤ng tr√°nh):</b><br/>
                                            {bookedDates.map(d => new Date(d).toLocaleDateString('vi-VN')).join(', ')}
                                        </div>
                                    )}

                                    <input required type="date" className={`w-full p-2 border rounded ${dateError ? 'border-red-500 bg-red-50' : ''}`} value={formData.date} onChange={e => handleChange('root', 'date', e.target.value)} />
                                    {dateError && <p className="text-red-500 text-sm mt-1 font-bold">{dateError}</p>}
                                </div>

                                <div><label className="text-sm font-medium">Ng√†y √Çm</label><input className="w-full p-2 border rounded" placeholder="VD: 16/11/·∫§t T·ªµ" value={formData.lunarDate} onChange={e => handleChange('root', 'lunarDate', e.target.value)} /></div>
                                <div><label className="text-sm font-medium">Gi·ªù l·ªÖ</label><input required type="time" className="w-full p-2 border rounded" value={formData.time} onChange={e => handleChange('root', 'time', e.target.value)} /></div>
                                <div><label className="text-sm font-medium">S·ªë kh√°ch</label><input type="number" className="w-full p-2 border rounded" placeholder="∆Ø·ªõc l∆∞·ª£ng..." value={formData.guestCount} onChange={e => handleChange('root', 'guestCount', e.target.value)} /></div>
                                <div className="md:col-span-2"><label className="text-sm font-medium">N·ªôi dung b·∫£ng l·ªÖ</label><input className="w-full p-2 border rounded" placeholder="VD: L·ªÖ H·∫±ng Thu·∫≠n - Th√†nh H√¥n" value={formData.ceremonyBoardContent} onChange={e => handleChange('root', 'ceremonyBoardContent', e.target.value)} /></div>
                                
                                <div className="md:col-span-3 bg-stone-50 p-3 rounded border flex flex-col sm:flex-row gap-4 items-center">
                                    <label className="flex items-center gap-2 cursor-pointer select-none">
                                        <input type="checkbox" className="w-5 h-5 text-amber-600 rounded" checked={formData.hasBanquet} onChange={e => handleChange('root', 'hasBanquet', e.target.checked)} />
                                        <span className="font-bold">C√≥ ƒë·∫∑t ti·ªác chay</span>
                                    </label>
                                    {formData.hasBanquet && <input type="text" placeholder="S·ªë b√†n (10 ng∆∞·ªùi/b√†n)..." className="flex-1 w-full p-2 border rounded" value={formData.banquetTables} onChange={e => handleChange('root', 'banquetTables', e.target.value)} />}
                                </div>
                                <div className="md:col-span-3 bg-stone-50 p-3 rounded border">
                                    <label className="block text-sm font-bold mb-2">Quay phim / Ch·ª•p h√¨nh</label>
                                    <div className="flex gap-4">
                                        <label className="flex items-center gap-2"><input type="radio" name="mediaOption" value="own" checked={formData.mediaOption === 'own'} onChange={e => handleChange('root', 'mediaOption', e.target.value)} /> T·ª± thu√™</label>
                                        <label className="flex items-center gap-2"><input type="radio" name="mediaOption" value="temple" checked={formData.mediaOption === 'temple'} onChange={e => handleChange('root', 'mediaOption', e.target.value)} /> Nh·ªù Ch√πa ch·ª•p <i className="text-xs text-stone-500">(Kh√¥ng quay phim)</i></label>
                                    </div>
                                </div>
                                <div className="md:col-span-3"><label className="text-sm font-medium">Trang tr√≠ hoa</label><input type="text" className="w-full p-2 border rounded" placeholder="VD: T√¥ng m√†u v√†ng, hoa c√∫c, phong c√°ch ƒë∆°n gi·∫£n..." value={formData.flowerPreferences} onChange={e => handleChange('root', 'flowerPreferences', e.target.value)} /></div>
                            </div>
                            <div className="mt-4"><label className="text-sm font-medium">Ghi ch√∫</label><textarea className="w-full p-2 border rounded h-20" placeholder="Gia ƒë√¨nh c·∫ßn Ch√πa ch√∫ √Ω th√™m ph·∫ßn g√¨ xin ghi r√µ (VD: S√≠nh l·ªÖ, gi·ªù gi·∫•c ƒë·∫∑c bi·ªát...)" value={formData.offeringsInfo} onChange={e => handleChange('root', 'offeringsInfo', e.target.value)}></textarea></div>
                        </div>
                        
                        <div className="flex justify-end gap-3 pt-4 border-t">
                            {isAdminMode && <button type="button" onClick={onCancel} className="px-5 py-2 border rounded hover:bg-stone-100">H·ªßy</button>}
                            <button type="submit" disabled={isSaving || dateError} className={`px-6 py-3 text-white rounded-lg shadow font-bold text-lg w-full sm:w-auto ${dateError || isSaving ? 'bg-stone-400 cursor-not-allowed' : 'bg-amber-600 hover:bg-amber-700'}`}>
                                {isSaving ? 'ƒêang g·ª≠i...' : 'G·ª¨I H·ªí S∆† ƒêƒÇNG K√ù'}
                            </button>
                        </div>
                    </form>
                </div>
            );
        };

        // --- NEW COMPONENT: M√ÄN H√åNH KH√ÅCH TH√ÄNH C√îNG ---
        const GuestSuccessView = ({ ceremony, onReset }) => {
            const handleDownload = () => {
                const link = document.createElement('a');
                link.href = URL.createObjectURL(createWordBlob(ceremony));
                link.download = `PhieuDangKy_${ceremony.groom.fullName}.doc`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            };

            return (
                <div className="max-w-2xl mx-auto text-center pt-10 fade-in px-4">
                    <div className="mb-6 flex justify-center">
                        <Icons.CheckCircle />
                    </div>
                    <h2 className="text-3xl font-serif font-bold text-green-700 mb-4">ƒêƒÉng K√Ω Th√†nh C√¥ng!</h2>
                    <p className="text-stone-600 mb-8">
                        M√¥ Ph·∫≠t, Nh√† Ch√πa ƒë√£ nh·∫≠n ƒë∆∞·ª£c th√¥ng tin ƒëƒÉng k√Ω c·ªßa gia ƒë√¨nh.<br/>
                        Qu√Ω v·ªã vui l√≤ng t·∫£i phi·∫øu ƒëƒÉng k√Ω b√™n d∆∞·ªõi ƒë·ªÉ l∆∞u tr·ªØ v√† ƒë·ªëi chi·∫øu.
                    </p>
                    
                    <div className="bg-white p-6 rounded-xl shadow-lg border border-stone-200 mb-8">
                        <h3 className="font-bold text-lg mb-2">{ceremony.groom.fullName} & {ceremony.bride.fullName}</h3>
                        <p className="text-sm text-stone-500 mb-4">M√£ h·ªì s∆°: #{ceremony.id.slice(-6)}</p>
                        
                        <button onClick={handleDownload} className="w-full bg-blue-600 text-white py-3 rounded-lg font-bold shadow hover:bg-blue-700 flex items-center justify-center gap-2 transition-transform hover:scale-105">
                            <Icons.Download /> üì• T·∫£i Phi·∫øu ƒêƒÉng K√Ω (L∆∞u v·ªÅ m√°y)
                        </button>
                        <p className="text-xs text-red-500 mt-2 italic">* Vui l√≤ng g·ª≠i file n√†y v·ªÅ email: {TEMPLE_EMAIL}</p>
                    </div>

                    <button onClick={onReset} className="text-amber-700 hover:underline text-sm font-medium">
                        &larr; Quay l·∫°i trang ƒëƒÉng k√Ω m·ªõi
                    </button>
                </div>
            );
        };

        const CeremonyDetailView = ({ ceremony, onBack, onEdit, onDelete }) => {
            const [script, setScript] = useState(ceremony.aiProgramScript || '');
            const [loading, setLoading] = useState(false);
            const formatDate = (dateStr) => dateStr ? new Date(dateStr).toLocaleDateString('vi-VN', { day: 'numeric', month: 'long', year: 'numeric' }) : '---';
            const handleGenerateScript = async () => { setLoading(true); const result = await generateCeremonyScript(ceremony); setScript(result); setLoading(false); };
            const handleExportWord = () => { const link = document.createElement('a'); link.href = URL.createObjectURL(createWordBlob(ceremony)); link.download = `DangKy_${ceremony.groom.fullName}.doc`; document.body.appendChild(link); link.click(); document.body.removeChild(link); };

            return (
                <div className="max-w-5xl mx-auto space-y-6 fade-in mb-10">
                    <div className="flex justify-between items-center"><button onClick={onBack} className="flex gap-2 hover:text-amber-700"><Icons.ArrowLeft /> Quay l·∫°i</button><div className="flex gap-2"><button onClick={onDelete} className="bg-red-50 text-red-600 px-3 py-2 rounded"><Icons.Trash2 /> X√≥a</button><button onClick={onEdit} className="bg-amber-50 text-amber-700 px-3 py-2 rounded"><Icons.Pencil /> S·ª≠a</button><button onClick={handleExportWord} className="bg-blue-700 text-white px-4 py-2 rounded"><Icons.Download /> T·∫£i Word</button></div></div>
                    <div className="bg-white rounded-xl shadow p-6 border border-stone-200 mt-4">
                        <div className="bg-amber-50 p-4 rounded mb-4 flex justify-between"><div><h2 className="text-xl font-bold">{ceremony.groom.fullName} & {ceremony.bride.fullName}</h2><p>{formatDate(ceremony.date)} - {ceremony.time}</p></div><div className="text-right"><p className="font-bold text-amber-700">LH: {ceremony.contactPhone}</p><span className="text-xs bg-green-100 text-green-800 px-2 py-1 rounded">ƒê√£ l∆∞u</span></div></div>
                        <div className="grid md:grid-cols-2 gap-6">
                            <div><h3 className="font-bold border-b mb-2">Nh√† Trai</h3><p>T√™n: {ceremony.groom.fullName}</p><p>SƒêT: {ceremony.groom.phone}</p></div>
                            <div><h3 className="font-bold border-b mb-2">Nh√† G√°i</h3><p>T√™n: {ceremony.bride.fullName}</p><p>SƒêT: {ceremony.bride.phone}</p></div>
                        </div>
                        <div className="mt-4 pt-4 border-t grid md:grid-cols-3 gap-4 text-sm">
                            <p><b>Ti·ªác:</b> {ceremony.hasBanquet ? `${ceremony.banquetTables} b√†n` : 'Kh√¥ng'}</p>
                            <p><b>Hoa:</b> {ceremony.flowerPreferences || 'Theo ch√πa'}</p>
                            <p><b>Media:</b> {ceremony.mediaOption === 'temple' ? 'Ch√πa ch·ª•p' : 'T·ª± thu√™'}</p>
                        </div>
                    </div>
                    <div className="bg-gradient-to-br from-amber-50 to-white rounded-2xl shadow-sm border border-amber-200 flex flex-col mt-4">
                        <div className="p-4 border-b border-amber-100 flex justify-between items-center"><h3 className="font-bold text-amber-800 flex gap-2"><span className="text-amber-500"><Icons.Sparkles /></span> Tr·ª£ l√Ω</h3>{!loading && !script && <button onClick={handleGenerateScript} className="text-xs bg-amber-600 text-white px-3 py-1 rounded hover:bg-amber-700">T·∫°o k·ªãch b·∫£n</button>}</div>
                        <div className="flex-1 p-4 overflow-y-auto max-h-[500px] text-sm text-stone-700">{loading ? <p className="text-center">ƒêang t·∫£i...</p> : script ? <div className="whitespace-pre-wrap">{script}</div> : <p className="text-center text-stone-400">Ch∆∞a c√≥ k·ªãch b·∫£n</p>}</div>
                    </div>
                </div>
            );
        };

        const App = () => {
            // --- STATE QU·∫¢N L√ù ---
            const [view, setView] = useState('public_form'); 
            const [isAdmin, setIsAdmin] = useState(false);
            const [ceremonies, setCeremonies] = useState([]);
            const [bookedDates, setBookedDates] = useState([]); // Danh s√°ch ng√†y ƒë√£ k√≠n
            const [selectedCeremony, setSelectedCeremony] = useState(null);
            const [guestSubmittedData, setGuestSubmittedData] = useState(null);
            const [isSyncing, setIsSyncing] = useState(false);
            const [isSaving, setIsSaving] = useState(false);

            useEffect(() => {
                const loadData = async () => {
                    if (GOOGLE_SCRIPT_URL) {
                        setIsSyncing(true);
                        try {
                            const res = await fetch(GOOGLE_SCRIPT_URL);
                            const cloudData = await res.json();
                            if (Array.isArray(cloudData)) {
                                setCeremonies(cloudData);
                                // Tr√≠ch xu·∫•t ng√†y ƒë√£ ƒë·∫∑t
                                const dates = cloudData.map(c => c.date).filter(d => d);
                                setBookedDates(dates);
                            }
                        } catch (err) { console.error("L·ªói t·∫£i data", err); } finally { setIsSyncing(false); }
                    }
                };
                // Lu√¥n t·∫£i d·ªØ li·ªáu khi kh·ªüi ƒë·ªông ƒë·ªÉ l·∫•y danh s√°ch ng√†y k√≠n (cho c·∫£ Kh√°ch v√† Admin)
                loadData();
            }, []);

            const handleLogin = () => {
                const pwd = prompt("Nh·∫≠p m·∫≠t kh·∫©u qu·∫£n tr·ªã vi√™n:");
                if (pwd === ADMIN_PASSWORD) {
                    setIsAdmin(true);
                    setView('list');
                } else if (pwd) {
                    alert("M·∫≠t kh·∫©u kh√¥ng ƒë√∫ng!");
                }
            };

            const handleCreate = async (data) => {
                if (GOOGLE_SCRIPT_URL) {
                    setIsSaving(true);
                    try {
                        await fetch(GOOGLE_SCRIPT_URL, {
                            method: 'POST',
                            mode: 'no-cors',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(data)
                        });
                        
                        if (isAdmin) {
                            alert("ƒê√£ th√™m h·ªì s∆° th√†nh c√¥ng!");
                            setView('list');
                            window.location.reload(); // Reload ƒë·ªÉ c·∫≠p nh·∫≠t ng√†y k√≠n
                        } else {
                            // KH√ÅCH: Chuy·ªÉn sang m√†n h√¨nh th√†nh c√¥ng
                            setGuestSubmittedData(data);
                            setView('guest_success');
                        }
                    } catch (err) {
                        alert("L·ªói k·∫øt n·ªëi! Vui l√≤ng th·ª≠ l·∫°i ho·∫∑c li√™n h·ªá tr·ª±c ti·∫øp.");
                    } finally {
                        setIsSaving(false);
                    }
                } else {
                    alert("Ch∆∞a c·∫•u h√¨nh Google Script URL!");
                }
            };

            const handleUpdate = (data) => {
                alert("Ch·∫ø ƒë·ªô s·ª≠a ƒëang ch·ªâ l∆∞u t·∫°m th·ªùi tr√™n tr√¨nh duy·ªát n√†y.");
                const updatedList = ceremonies.map(c => c.id === data.id ? data : c);
                setCeremonies(updatedList); setSelectedCeremony(data); setView('detail');
            };

            const handleDelete = (id) => {
                if (confirm("X√≥a h·ªì s∆° n√†y?")) {
                    setCeremonies(ceremonies.filter(c => c.id !== id));
                    setSelectedCeremony(null); setView('list');
                }
            };

            // --- GIAO DI·ªÜN CH√çNH ---
            return (
                <div className="min-h-screen flex flex-col font-sans bg-amber-50/50">
                    <nav className="bg-amber-800 text-amber-50 shadow-md sticky top-0 z-50">
                        <div className="container mx-auto px-4 h-16 flex items-center justify-between">
                            <div className="flex items-center gap-3">
                                <div className="w-10 h-10 bg-amber-900 rounded-full flex items-center justify-center border-2 border-amber-600"><span className="font-serif font-bold text-xl">B</span></div>
                                <h1 className="font-bold text-lg">{TEMPLE_NAME}</h1>
                            </div>
                            {isAdmin && (
                                <button onClick={() => { setIsAdmin(false); setView('public_form'); }} className="text-xs bg-amber-900 px-3 py-1 rounded hover:bg-amber-700">ƒêƒÉng xu·∫•t</button>
                            )}
                        </div>
                    </nav>

                    <main className="flex-grow container mx-auto px-4 py-8">
                        {/* 1. GIAO DI·ªÜN KH√ÅCH: FORM NH·∫¨P */}
                        {!isAdmin && view === 'public_form' && (
                            <div className="max-w-4xl mx-auto">
                                <div className="text-center mb-8 fade-in">
                                    <h2 className="text-3xl font-serif font-bold text-stone-800 mb-2">ƒêƒÉng K√Ω L·ªÖ H·∫±ng Thu·∫≠n</h2>
                                    <p className="text-stone-600">Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin b√™n d∆∞·ªõi ƒë·ªÉ g·ª≠i v·ªÅ Nh√† Ch√πa.</p>
                                </div>
                                <RegistrationForm onSubmit={handleCreate} isSaving={isSaving} isAdminMode={false} bookedDates={bookedDates} />
                            </div>
                        )}

                        {/* 2. GIAO DI·ªÜN KH√ÅCH: TH√ÄNH C√îNG */}
                        {!isAdmin && view === 'guest_success' && guestSubmittedData && (
                            <GuestSuccessView 
                                ceremony={guestSubmittedData} 
                                onReset={() => { setGuestSubmittedData(null); setView('public_form'); window.location.reload(); }} 
                            />
                        )}

                        {/* 3. GIAO DI·ªÜN ADMIN */}
                        {isAdmin && view === 'list' && (
                            <div className="space-y-6 fade-in">
                                <div className="flex justify-between items-center">
                                    <h2 className="text-3xl font-serif font-bold text-stone-800">Danh S√°ch Qu·∫£n L√Ω</h2>
                                    <div className="flex gap-2">
                                        <button onClick={() => window.location.reload()} className="bg-stone-100 text-stone-600 px-3 py-2 rounded hover:bg-stone-200"><Icons.Refresh /> T·∫£i l·∫°i</button>
                                        <button onClick={() => setView('form')} className="flex items-center gap-2 bg-amber-600 text-white px-5 py-2.5 rounded hover:bg-amber-700 shadow transition"><Icons.Plus /> Th√™m M·ªõi</button>
                                    </div>
                                </div>
                                {isSyncing ? <div className="text-center py-10"><div className="loader mx-auto mb-2"></div><p>ƒêang t·∫£i d·ªØ li·ªáu...</p></div> : 
                                ceremonies.length === 0 ? <div className="text-center py-10 bg-white rounded border"><p>Ch∆∞a c√≥ d·ªØ li·ªáu.</p></div> : 
                                    <div className="grid md:grid-cols-2 xl:grid-cols-3 gap-6">
                                        {ceremonies.map(ceremony => (
                                            <div key={ceremony.id} onClick={() => { setSelectedCeremony(ceremony); setView('detail'); }} className="bg-white rounded-xl p-5 shadow hover:shadow-lg border cursor-pointer group">
                                                <div className="flex justify-between mb-4"><div className="bg-amber-50 text-amber-800 rounded px-3 py-1 border text-center min-w-[60px]"><div className="text-xs font-bold uppercase">Th√°ng {new Date(ceremony.date).getMonth() + 1}</div><div className="text-2xl font-bold leading-none">{new Date(ceremony.date).getDate()}</div></div><span className="text-xs px-2 py-1 rounded bg-stone-100 text-stone-500">{ceremony.hasBanquet ? 'C√≥ ti·ªác' : 'L·ªÖ'}</span></div>
                                                <h3 className="text-lg font-bold group-hover:text-amber-700 truncate">{ceremony.groom.fullName} & {ceremony.bride.fullName}</h3>
                                                <p className="text-sm text-stone-500 mt-1">{ceremony.time} - LH: {ceremony.contactPhone}</p>
                                            </div>
                                        ))}
                                    </div>
                                }
                            </div>
                        )}

                        {isAdmin && view === 'form' && <RegistrationForm onSubmit={handleCreate} onCancel={() => setView('list')} isSaving={isSaving} isAdminMode={true} bookedDates={bookedDates} />}
                        {isAdmin && view === 'edit' && selectedCeremony && <RegistrationForm initialData={selectedCeremony} onSubmit={handleUpdate} onCancel={() => setView('detail')} isAdminMode={true} bookedDates={bookedDates} />}
                        {isAdmin && view === 'detail' && selectedCeremony && <CeremonyDetailView ceremony={selectedCeremony} onBack={() => setView('list')} onEdit={() => setView('edit')} onDelete={() => handleDelete(selectedCeremony.id)} />}
                    </main>

                    <footer className="bg-stone-800 text-stone-400 py-6 text-center text-sm relative">
                        <p className="font-serif text-lg mb-2">{TEMPLE_NAME}</p>
                        <p>{TEMPLE_ADDRESS}</p>
                        
                        {/* N√∫t ƒëƒÉng nh·∫≠p Admin ·∫©n ·ªü g√≥c d∆∞·ªõi */}
                        {!isAdmin && (
                            <button onClick={handleLogin} className="absolute bottom-4 right-4 text-stone-600 hover:text-stone-300 flex items-center gap-1 opacity-50 hover:opacity-100 transition">
                                <Icons.Lock /> <span className="text-xs">Qu·∫£n tr·ªã</span>
                            </button>
                        )}
                    </footer>
                </div>
            );
        };
        const root = ReactDOM.createRoot(document.getElementById('root')); root.render(<App />);
    </script>
</body>

</html>
